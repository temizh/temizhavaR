library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
library(DBI)
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
dbDisconnect(mydb)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
browser()
browser()
browser()
browser()
browser()
hourly_detail_save_to_database <- function(processed_data, station_name) {
data <- processed_data$data
param_names <- processed_data$param_names
station_name <- processed_data$station_name
mydb <- dbConnect(RSQLite::SQLite(), dbname = "temiz-hava.sqlite", encoding = "UTF-8")
data$Tarih <- format(data$Tarih, "%Y-%m-%d %H:%M:%S")
col_mapping <- c("Istasyon" = "Istasyon" ,"location_id"= "location_id","Tarih" = "Tarih", "PM10" = "PM10", "PM2.5" = "\"PM2.5\"", "SO2" = "SO2","CO" = "CO", "NO2" = "NO2", "NOX" = "NOX", "NO" = "NO", "O3" = "O3")
data$Istasyon <- station_name
station_count <- dbGetQuery(mydb, paste0("SELECT COUNT(*) FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
if (station_count > 0) {
dbExecute(mydb, paste0("DELETE FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
}
qry <- paste0("SELECT Id FROM location WHERE Sehir_Istasyon = '", station_name, "'")
location_ids <- dbGetQuery(mydb, qry)
browser()
browser()
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
browser()
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
browser()
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
library(temizhavaR)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
hourly_detail_save_to_database <- function(processed_data, station_name) {
data <- processed_data$data
param_names <- processed_data$param_names
station_name <- processed_data$station_name
mydb <- dbConnect(RSQLite::SQLite(), dbname = "temiz-hava.sqlite", encoding = "UTF-8")
data$Tarih <- format(data$Tarih, "%Y-%m-%d %H:%M:%S")
col_mapping <- c("Istasyon" = "Istasyon" ,"location_id"= "location_id","Tarih" = "Tarih", "PM10" = "PM10", "PM2.5" = "\"PM2.5\"", "SO2" = "SO2","CO" = "CO", "NO2" = "NO2", "NOX" = "NOX", "NO" = "NO", "O3" = "O3")
data$Istasyon <- station_name
station_count <- dbGetQuery(mydb, paste0("SELECT COUNT(*) FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
if (station_count > 0) {
dbExecute(mydb, paste0("DELETE FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
}
qry <- paste0("SELECT Id FROM location WHERE Sehir_Istasyon = '", station_name, "'")
location_ids <- dbGetQuery(mydb, qry)
if (nrow(location_ids) > 0) {
data$location_id <- rep(location_ids$Id, nrow(data))
}
head(data$location_id)
print(paste("location_ids : ", location_ids))
# location_ids <- dbGetQuery(mydb, "SELECT Id FROM location WHERE Sehir_Istasyon = 'Adana - Seyhan'")
# if (nrow(location_ids) > 0) {
#   data$location_id <- rep(location_ids$Id, nrow(data))
# }
dbWriteTable(mydb, "hourly_detail", data, col.names = col_mapping, append = TRUE, fileEncoding = "UTF-8")
query <- paste0("SELECT * FROM hourly_detail WHERE Istasyon = '", station_name, "'")
query_result <- dbGetQuery(mydb, query)
dbDisconnect(mydb)
return(head(query_result))
}
#' Hourly detail save to database
#'
#' @param processed_data processed data.
#' @export
hourly_detail_save_to_database <- function(processed_data, station_name) {
data <- processed_data$data
param_names <- processed_data$param_names
station_name <- processed_data$station_name
mydb <- dbConnect(RSQLite::SQLite(), dbname = "temiz-hava.sqlite", encoding = "UTF-8")
data$Tarih <- format(data$Tarih, "%Y-%m-%d %H:%M:%S")
col_mapping <- c("Istasyon" = "Istasyon" ,"location_id"= "location_id","Tarih" = "Tarih", "PM10" = "PM10", "PM2.5" = "\"PM2.5\"", "SO2" = "SO2","CO" = "CO", "NO2" = "NO2", "NOX" = "NOX", "NO" = "NO", "O3" = "O3")
data$Istasyon <- station_name
station_count <- dbGetQuery(mydb, paste0("SELECT COUNT(*) FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
if (station_count > 0) {
dbExecute(mydb, paste0("DELETE FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
}
qry <- paste0("SELECT Id FROM location WHERE Sehir_Istasyon = '", station_name, "'")
location_ids <- dbGetQuery(mydb, qry)
if (nrow(location_ids) > 0) {
data$location_id <- rep(location_ids$Id, nrow(data))
browser()
}
head(data$location_id)
print(paste("location_ids : ", location_ids))
# location_ids <- dbGetQuery(mydb, "SELECT Id FROM location WHERE Sehir_Istasyon = 'Adana - Seyhan'")
# if (nrow(location_ids) > 0) {
#   data$location_id <- rep(location_ids$Id, nrow(data))
# }
dbWriteTable(mydb, "hourly_detail", data, col.names = col_mapping, append = TRUE, fileEncoding = "UTF-8")
query <- paste0("SELECT * FROM hourly_detail WHERE Istasyon = '", station_name, "'")
query_result <- dbGetQuery(mydb, query)
dbDisconnect(mydb)
return(head(query_result))
}
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
#' Hourly detail save to database
#'
#' @param processed_data processed data.
#' @export
hourly_detail_save_to_database <- function(processed_data, station_name) {
data <- processed_data$data
param_names <- processed_data$param_names
station_name <- processed_data$station_name
mydb <- dbConnect(RSQLite::SQLite(), dbname = "temiz-hava.sqlite", encoding = "UTF-8")
data$Tarih <- format(data$Tarih, "%Y-%m-%d %H:%M:%S")
col_mapping <- c("Istasyon" = "Istasyon" ,"location_id"= "location_id","Tarih" = "Tarih", "PM10" = "PM10", "PM2.5" = "\"PM2.5\"", "SO2" = "SO2","CO" = "CO", "NO2" = "NO2", "NOX" = "NOX", "NO" = "NO", "O3" = "O3")
data$Istasyon <- station_name
station_count <- dbGetQuery(mydb, paste0("SELECT COUNT(*) FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
if (station_count > 0) {
dbExecute(mydb, paste0("DELETE FROM hourly_detail WHERE Istasyon = '", station_name, "'"))
}
qry <- paste0("SELECT Id FROM location WHERE Sehir_Istasyon = '", station_name, "'")
location_ids <- dbGetQuery(mydb, qry)
if (nrow(location_ids) > 0) {
data$location_id <- rep(location_ids$Id, nrow(data))
browser()
}
head(data$location_id)
print(paste("location_ids : ", location_ids))
# location_ids <- dbGetQuery(mydb, "SELECT Id FROM location WHERE Sehir_Istasyon = 'Adana - Seyhan'")
# if (nrow(location_ids) > 0) {
#   data$location_id <- rep(location_ids$Id, nrow(data))
# }
dbWriteTable(mydb, "hourly_detail", data, col.names = col_mapping, append = TRUE, fileEncoding = "UTF-8")
query <- paste0("SELECT * FROM hourly_detail WHERE Istasyon = '", station_name, "'")
query_result <- dbGetQuery(mydb, query)
dbDisconnect(mydb)
return(head(query_result))
}
library(temizhavaR)
istasyon <- read_excel(paste0(data_dir, "mersin-akdeniz-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Akdeniz")
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin-Tarsus")
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(temizhavaR)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
View(processed_data)
processed_data$station_name
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
hourly_detail_save_to_database(processed_data, "Adana - Çatalan")
processed_data$station_name
View(processed_data)
View(istasyon)
location <- dbReadTable(mydb, "location")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
location <- dbReadTable(mydb, "location")
View(location)
library(temizhavaR)
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(temizhavaR)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
View(location_ids)
View(query_result)
station_name
library(temizhavaR)
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(temizhavaR)
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
hourly_detail_save_to_database(processed_data, "Adana-Çukurova")
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çukurova")
library(temizhavaR)
stasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çukurova")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS location")
mydb_location <- "
CREATE TABLE location (
Bolge TEXT,
Sehir TEXT,
Plaka TEXT,
Istasyonlar TEXT,
Sehir_Istasyon TEXT,
Id TEXT PRIMARY KEY
);
"
# CREATE TABLE
dbExecute(mydb, mydb_location)
location_data <- read_excel("C:/Users/Hp/Desktop/location_veri_ayri.xlsx")
location_data$Id <- sapply(1:nrow(location_data), function(i) as.character(UUIDgenerate()))
View(location_data)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çukurova")
library(temizhavaR)
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS location")
mydb_location <- "
CREATE TABLE location (
Bolge TEXT,
Sehir TEXT,
Plaka TEXT,
Istasyonlar TEXT,
Sehir_Istasyon TEXT,
Id TEXT PRIMARY KEY
);
"
# CREATE TABLE
dbExecute(mydb, mydb_location)
location_data <- read_excel("C:/Users/Hp/Desktop/location_veri_birlesik.xlsx")
location_data$Id <- sapply(1:nrow(location_data), function(i) as.character(UUIDgenerate()))
location <- dbReadTable(mydb, "location")
View(location)
dbWriteTable(mydb, "location", location_data, append = TRUE, row.names = FALSE)
location <- dbReadTable(mydb, "location")
View(location)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana-Çatalan")
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çatalan")
hourly_detail_save_to_database(processed_data, "Adana - Çatalan")
stasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
library(temizhavaR)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS location")
mydb_location <- "
CREATE TABLE location (
Bolge TEXT,
Sehir TEXT,
Plaka TEXT,
Istasyonlar TEXT,
Sehir_Istasyon TEXT,
Id TEXT PRIMARY KEY
);
"
location_data <- read_excel("C:/Users/Hp/Desktop/location_veri_ayri.xlsx")
location_data$Id <- sapply(1:nrow(location_data), function(i) as.character(UUIDgenerate()))
dbWriteTable(mydb, "location", location_data, append = TRUE, row.names = FALSE)
location <- dbReadTable(mydb, "location")
View(location)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
istasyon <- read_excel(paste0(data_dir, "adana-seyhan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Seyhan")
istasyon <- read_excel(paste0(data_dir, "erzincan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Erzincan")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS hourly_detail")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS hourly_detail")
mydb_hourly_detail <- "
CREATE TABLE hourly_detail (
Istasyon TEXT,
location_id TEXT,
Tarih DATETIME,
PM10 DOUBLE,
\"PM2.5\" DOUBLE,
SO2 DOUBLE,
CO DOUBLE,
NO2 DOUBLE,
NOX DOUBLE,
NO DOUBLE,
O3 DOUBLE
);
"
dbExecute(mydb, mydb_hourly_detail)
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
library(tidyverse)
library(readxl)
library(dplyr)
library(temizhavaR)
library(DBI)
library(readxl)
library(uuid)
library(dygraphs)
data_dir <- "C:/Hourly_detail/"
istasyon <- read_excel(paste0(data_dir, "adana-catalan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çatalan")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "adana-cukurova-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Çukurova")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "adana-dogankent-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Doğankent")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "adana-meteoroloji-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Meteoroloji")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
istasyon <- read_excel(paste0(data_dir, "adana-seyhan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Seyhan")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "adana-valilik-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Adana - Valilik")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "erzincan-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Erzincan")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "erzincan-trafik-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Erzincan - Trafik")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
istasyon <- read_excel(paste0(data_dir, "mersin-akdeniz-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin - Akdeniz")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
istasyon <- read_excel(paste0(data_dir, "mersin-huzurkent-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin - Huzurkent")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
istasyon <- read_excel(paste0(data_dir, "mersin-tarsus-saatlik-detay.xlsx"))
processed_data <- data_preprocessing(istasyon)
hourly_detail_save_to_database(processed_data, "Mersin - Tarsus")
hourly_detail <- dbReadTable(mydb, "hourly_detail")
View(hourly_detail)
dbDisconnect(mydb)
