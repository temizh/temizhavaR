}
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Erzincan"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(result_sorted)
result_message <- print(paste(parameter_name," : ortalaması 50 esiginin üstüne cikan istasyonlar" ))
print(result_message)
pm10_10 <- calculate_exceedance_days_daily(all_daily_detail_data, parameter, threshold = 50)
pm10_4 <- rbind(result_message, pm10_10)
result_message <- print(paste(parameter_name," : ortalaması 50 esiginin üstüne cikan istasyonlar" ))
print(result_message)
pm10_10 <- calculate_exceedance_days_daily(all_daily_detail_data, parameter, threshold = 50)
pm10_10 <- rbind(result_message, pm10_10)
View(pm10_10)
library(temizhavaR)
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
raw_dir <- "C:/TemizHava_raw_data2023/"
library(readxl)
library(dplyr)
library(lubridate)
library(RSQLite)
library(temizhavaR)
source("init.TemizHava.R")
setwd(raw_dir)
#SAVE EXCEL TO DATABASE FOR DAILY DETAIL
istasyonlar <- list.files(pattern = "xlsx", recursive = TRUE)
gunluk_istasyonlar <- istasyonlar[grep("gunluk_detay", istasyonlar)]
error_log <- list()
for (istasyon_file in gunluk_istasyonlar) {
tryCatch({
istasyon <- read_excel(istasyon_file)
processed_data <- data_preprocessing(istasyon)
daily_detail_save_to_database(processed_data)
cat(paste("Processed and saved:", istasyon_file, "\n"))
}, error = function(e) {
# Log the error with file name
error_log[[istasyon_file]] <- e
cat(paste("Error processing:", istasyon_file, "\n"))
})
}
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
station_name <- "Erzincan"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
print("Istasyonlar 50 esigini kac gun boyunca astilar:")
print(result_above$ExceedanceDays %>% arrange(desc(ExceedsThreshold)))
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
result_message <- print(paste(parameter_name," : ortalaması 50 esiginin üstüne cikan istasyonlar" ))
print(result_message)
pm10_10 <- calculate_exceedance_days_daily(all_daily_detail_data, parameter, threshold = 50)
pm10_10 <- rbind(result_message, pm10_10)
result_message <- print(paste(parameter_name," : Istasyonlar 45 esiginin kac gun boyunca altında kaldılar" ))
print(result_message)
pm10_12 <- calculate_below_exceedance_days_all_stations(parameter, threshold = 45)
result_sorted <- pm10_12$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_12 <- rbind(result_message, result_sorted)
View(pm10_12)
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
station_name <- "Karabük - Safranbolu"
query <- paste0("DELETE FROM daily_detail WHERE Istasyon = '", station_name, "'")
# DELETE komutunu çalıştır
dbExecute(mydb, query)
dbDisconnect(mydb)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
station_name <- "Erzincan"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
View(result_sorted)
View(pm10_11)
View(result_sorted)
View(pm10_11)
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
View(daily_detail_data)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
create_hourly_time_series_graph(daily_detail_data, station_name, parameters)
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
daily_detail <- dbReadTable(mydb, "daily_detail")
View(daily_detail)
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS daily_detail")
mydb_daily_detail <- "
CREATE TABLE daily_detail(
Istasyon TEXT,
location_id TEXT,
Tarih DATETIME,
PM10 DOUBLE,
\"PM2.5\" DOUBLE,
SO2 DOUBLE,
CO DOUBLE,
NO2 DOUBLE,
NOX DOUBLE,
NO DOUBLE,
O3 DOUBLE
);
"
daily_detail <- dbReadTable(mydb, "daily_detail")
dbExecute(mydb, mydb_daily_detail)
daily_detail <- dbReadTable(mydb, "daily_detail")
library(readxl)
library(dplyr)
library(lubridate)
library(RSQLite)
library(temizhavaR)
source("init.TemizHava.R")
setwd(raw_dir)
#SAVE EXCEL TO DATABASE FOR DAILY DETAIL
istasyonlar <- list.files(pattern = "xlsx", recursive = TRUE)
gunluk_istasyonlar <- istasyonlar[grep("gunluk_detay", istasyonlar)]
error_log <- list()
for (istasyon_file in gunluk_istasyonlar) {
tryCatch({
istasyon <- read_excel(istasyon_file)
processed_data <- data_preprocessing(istasyon)
daily_detail_save_to_database(processed_data)
cat(paste("Processed and saved:", istasyon_file, "\n"))
}, error = function(e) {
# Log the error with file name
error_log[[istasyon_file]] <- e
cat(paste("Error processing:", istasyon_file, "\n"))
})
}
# Print error log
if (length(error_log) > 0) {
cat("Errors occurred during processing:\n")
print(error_log)
}
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
station_name <- "Karabük-Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
dbDisconnect(mydb)
getwd()
setwd("C:/TemizHava_raw_data2023/")
getwd()
getwd()
library(readxl)
library(dplyr)
library(lubridate)
library(RSQLite)
library(temizhavaR)
source("init.TemizHava.R")
setwd(raw_dir)
#SAVE EXCEL TO DATABASE FOR DAILY DETAIL
istasyonlar <- list.files(pattern = "xlsx", recursive = TRUE)
gunluk_istasyonlar <- istasyonlar[grep("gunluk_detay", istasyonlar)]
error_log <- list()
for (istasyon_file in gunluk_istasyonlar) {
tryCatch({
istasyon <- read_excel(istasyon_file)
processed_data <- data_preprocessing(istasyon)
daily_detail_save_to_database(processed_data)
cat(paste("Processed and saved:", istasyon_file, "\n"))
}, error = function(e) {
# Log the error with file name
error_log[[istasyon_file]] <- e
cat(paste("Error processing:", istasyon_file, "\n"))
})
}
# Print error log
if (length(error_log) > 0) {
cat("Errors occurred during processing:\n")
print(error_log)
}
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük-Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
result_message <- print(paste(parameter_name," : Istasyonlar 45 esiginin kac gun boyunca altında kaldılar" ))
print(result_message)
pm10_12 <- calculate_below_exceedance_days_all_stations(parameter, threshold = 45)
result_sorted <- pm10_12$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_12 <- rbind(result_message, result_sorted)
View(pm10_12)
head(pm10_11)
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
head(pm10_11)
exceedance_days <- calculate_exceedance_days_daily(daily_detail_data, parameter, threshold = 45)
print(paste("45 esiginin uzerinde asilma", exceedance_days, "gun boyunca gerceklesti."))
calculate_overall_average_by_city(parameter)
calculate_overall_average_by_city(parameter)
View(all_daily_detail_data)
calculate_overall_average_by_city_threshold(parameter)
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
calculate_overall_average_by_city_threshold(parameter)
calculate_overall_average_by_city_threshold(parameter)
calculate_overall_average_by_city_threshold(parameter)
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
create_hourly_time_series_graph(daily_detail_data, station_name, parameters)
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
View(all_daily_detail_data)
library(temizhavaR)
all_daily_detail_data <- all_daily_detail_load_from_database()
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
getwd()
setwd("C:/TemizHava_raw_data2023/")
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
View(pm10_11)
View(all_daily_detail_data)
raw_dir <- "C:/TemizHava_raw_data2023/"
output_dir <- paste0(raw_dir, "__results/")
if (!exists(output_dir))
dir.create(output_dir)
result_pm10_hourly_excel_file <- paste0(output_dir, "results_PM10_hourly.xlsx")
result_pm10_daily_excel_file <- paste0(output_dir, "results_PM10_daily.xlsx")
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
# delete table
dbExecute(mydb, "DROP TABLE IF EXISTS daily_detail")
mydb_daily_detail <- "
CREATE TABLE daily_detail(
Istasyon TEXT,
location_id TEXT,
Tarih DATETIME,
PM10 DOUBLE,
\"PM2.5\" DOUBLE,
SO2 DOUBLE,
CO DOUBLE,
NO2 DOUBLE,
NOX DOUBLE,
NO DOUBLE,
O3 DOUBLE
);
"
dbExecute(mydb, mydb_daily_detail)
daily_detail <- dbReadTable(mydb, "daily_detail")
dbDisconnect(mydb)
library(readxl)
library(dplyr)
library(lubridate)
library(RSQLite)
library(temizhavaR)
source("init.TemizHava.R")
setwd(raw_dir)
#SAVE EXCEL TO DATABASE FOR DAILY DETAIL
istasyonlar <- list.files(pattern = "xlsx", recursive = TRUE)
gunluk_istasyonlar <- istasyonlar[grep("gunluk_detay", istasyonlar)]
error_log <- list()
for (istasyon_file in gunluk_istasyonlar) {
tryCatch({
istasyon <- read_excel(istasyon_file)
processed_data <- data_preprocessing(istasyon)
daily_detail_save_to_database(processed_data)
cat(paste("Processed and saved:", istasyon_file, "\n"))
}, error = function(e) {
# Log the error with file name
error_log[[istasyon_file]] <- e
cat(paste("Error processing:", istasyon_file, "\n"))
})
}
# Print error log
if (length(error_log) > 0) {
cat("Errors occurred during processing:\n")
print(error_log)
}
View(istasyon)
library(DBI)
library(readxl)
library(uuid)
#library(RSQLite)
# create a connection to database
mydb <- dbConnect(RSQLite::SQLite(), "temiz-hava.sqlite")
daily_detail <- dbReadTable(mydb, "daily_detail")
library(dplyr)
library(temizhavaR)
library(DBI)
library(dygraphs)
library(writexl)
#source(init.TemizHavaR_2023.R)
# if there is no result_dir give error that edit couldnt found and run again
station_name <- "Karabük - Safranbolu"
station_names <- c("Mersin - Tarsus", "Adana-Seyhan")
parameters <- c("PM10")
total_days <- 365
parameter = "PM10"
parameter_name <- "PM10"
city_name <- "ADANA"
daily_detail_data <- daily_detail_load_from_database(station_name)
all_daily_detail_data <- all_daily_detail_load_from_database()
result_message <- print(paste(parameter_name," : Istasyonlar 50 esigini kac gun boyunca astilar" ))
print(result_message)
pm10_11 <- calculate_above_exceedance_days_all_stations(parameter, threshold = 50)
result_sorted <- pm10_11$ExceedanceDays %>% arrange(desc(ExceedsThreshold))
pm10_11 <- rbind(result_message, result_sorted)
calculate_overall_average_by_city_threshold(parameter)
library(temizhavaR)
calculate_overall_average_by_city_threshold(parameter)
